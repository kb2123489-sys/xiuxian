# åŠŸèƒ½æ¨¡å—åˆ†æä¸ä»»åŠ¡åˆ†é…æ–¹æ¡ˆ

## ğŸ“Š é¡¹ç›®åŠŸèƒ½æ¨¡å—æ€»è§ˆ

### æ ¸å¿ƒç³»ç»Ÿæ¨¡å—ï¼ˆ18ä¸ªï¼‰

| æ¨¡å—å           | ç›®å½•                  | ä¾èµ–å…³ç³»                   | å¤æ‚åº¦     | è¯´æ˜                  |
| ---------------- | --------------------- | -------------------------- | ---------- | --------------------- |
| **meditation**   | `views/meditation/`   | ä½                         | â­â­       | æ‰“åä¿®ç‚¼ç³»ç»Ÿ          |
| **breakthrough** | `views/breakthrough/` | ä¸­ï¼ˆä¾èµ– cultivationï¼‰     | â­â­â­     | å¢ƒç•Œçªç ´ç³»ç»Ÿ          |
| **battle**       | `views/battle/`       | ä¸­ï¼ˆä¾èµ– adventureï¼‰       | â­â­â­     | æˆ˜æ–—ç³»ç»Ÿå¤„ç†          |
| **items**        | `views/items/`        | ä½                         | â­â­       | ç‰©å“ä½¿ç”¨ã€ç®¡ç†        |
| **equipment**    | `views/equipment/`    | ä½ï¼ˆä¾èµ– itemsï¼‰           | â­â­       | è£…å¤‡ç©¿æˆ´ã€å¼ºåŒ–        |
| **cultivation**  | `views/cultivation/`  | ä½                         | â­â­       | åŠŸæ³•å­¦ä¹ ã€ä¿®ç‚¼        |
| **alchemy**      | `views/alchemy/`      | ä¸­ï¼ˆä¾èµ– itemsï¼‰           | â­â­â­     | ç‚¼ä¸¹ç³»ç»Ÿ              |
| **character**    | `views/character/`    | ä½                         | â­â­       | è§’è‰²å±æ€§ã€å¤©èµ‹ã€ç§°å·  |
| **shop**         | `views/shop/`         | ä½ï¼ˆä¾èµ– itemsï¼‰           | â­â­       | å•†åº—ç³»ç»Ÿ              |
| **settings**     | `views/settings/`     | ä½                         | â­         | æ¸¸æˆè®¾ç½®              |
| **realm**        | `views/realm/`        | é«˜ï¼ˆä¾èµ– adventureï¼‰       | â­â­â­â­   | ç§˜å¢ƒæ¢ç´¢ç³»ç»Ÿ          |
| **pet**          | `views/pet/`          | ä¸­ï¼ˆä¾èµ– itemsï¼‰           | â­â­â­     | çµå® ç³»ç»Ÿ              |
| **lottery**      | `views/lottery/`      | ä½                         | â­â­       | æŠ½å¥–ç³»ç»Ÿ              |
| **sect**         | `views/sect/`         | é«˜ï¼ˆä¾èµ– adventure, shopï¼‰ | â­â­â­â­   | å®—é—¨ç³»ç»Ÿ              |
| **achievement**  | `views/achievement/`  | ä½                         | â­â­       | æˆå°±ç³»ç»Ÿ              |
| **adventure**    | `views/adventure/`    | é«˜ï¼ˆæ ¸å¿ƒæ¨¡å—ï¼‰             | â­â­â­â­â­ | å†ç»ƒ/å†’é™©ç³»ç»Ÿï¼ˆæ ¸å¿ƒï¼‰ |
| **dailyQuest**   | `views/dailyQuest/`   | ä¸­ï¼ˆä¾èµ–æ‰€æœ‰æ¨¡å—ï¼‰         | â­â­â­     | æ—¥å¸¸ä»»åŠ¡ç³»ç»Ÿ          |
| **grotto**       | `views/grotto/`       | ä¸­                         | â­â­â­     | æ´åºœç³»ç»Ÿ              |

---

### æœåŠ¡å±‚æ¨¡å—ï¼ˆ5ä¸ªï¼‰

| æœåŠ¡å                       | æ–‡ä»¶                                   | ä¾èµ–å…³ç³»                            | å¤æ‚åº¦   |
| ---------------------------- | -------------------------------------- | ----------------------------------- | -------- |
| **adventureTemplateService** | `services/adventureTemplateService.ts` | ä½                                  | â­â­     |
| **battleService**            | `services/battleService.ts`            | ä¸­ï¼ˆä¾èµ– adventureTemplateServiceï¼‰ | â­â­â­â­ |
| **randomService**            | `services/randomService.ts`            | ä½                                  | â­â­     |
| **shopService**              | `services/shopService.ts`              | ä½                                  | â­â­     |
| **templateService**          | `services/templateService.ts`          | ä½                                  | â­â­     |

---

### çŠ¶æ€ç®¡ç† Hooksï¼ˆ11ä¸ªï¼‰

| Hook å                    | æ–‡ä»¶                              | å¤æ‚åº¦   | è¯´æ˜                                   |
| -------------------------- | --------------------------------- | -------- | -------------------------------------- |
| **useGameState**           | `hooks/useGameState.ts`           | â­â­â­â­ | æ¸¸æˆçŠ¶æ€ç®¡ç†ï¼ˆæ ¸å¿ƒï¼Œéœ€é‡æ„ä¸º zustandï¼‰ |
| **useAppState**            | `hooks/useAppState.ts`            | â­â­â­   | UI çŠ¶æ€ç®¡ç†ï¼ˆéœ€é‡æ„ä¸º zustandï¼‰        |
| **useGameEffects**         | `hooks/useGameEffects.ts`         | â­â­     | æ¸¸æˆå‰¯ä½œç”¨å¤„ç†                         |
| **useAutoFeatures**        | `hooks/useAutoFeatures.ts`        | â­â­â­   | è‡ªåŠ¨åŠŸèƒ½ï¼ˆè‡ªåŠ¨æ‰“åã€å†ç»ƒï¼‰             |
| **useBattleResultHandler** | `hooks/useBattleResultHandler.ts` | â­â­     | æˆ˜æ–—ç»“æœå¤„ç†                           |
| **useDeathDetection**      | `hooks/useDeathDetection.ts`      | â­â­     | æ­»äº¡æ£€æµ‹                               |
| **usePassiveRegeneration** | `hooks/usePassiveRegeneration.ts` | â­â­     | è¢«åŠ¨å›è¡€                               |
| **useAutoGrottoHarvest**   | `hooks/useAutoGrottoHarvest.ts`   | â­â­     | æ´åºœè‡ªåŠ¨æ”¶è·                           |
| **useLevelUp**             | `hooks/useLevelUp.ts`             | â­â­â­   | ç­‰çº§æå‡å¤„ç†                           |
| **useRebirth**             | `hooks/useRebirth.ts`             | â­â­     | æ¶…æ§ƒé‡ç”Ÿ                               |
| **useGameInitialization**  | `hooks/useGameInitialization.ts`  | â­â­     | æ¸¸æˆåˆå§‹åŒ–                             |

---

### UI ç»„ä»¶ï¼ˆ44ä¸ªï¼‰

**å¼¹çª—ç»„ä»¶ï¼ˆModalï¼‰**: çº¦ 30+ ä¸ª
**é¢æ¿ç»„ä»¶ï¼ˆPanelï¼‰**: StatsPanel, LogPanel, EquipmentPanel
**å…¶ä»–ç»„ä»¶**: GameView, GameHeader, ActionBar, ModalsContainer ç­‰

---

## ğŸ¯ é‡æ„ä»»åŠ¡åˆ†é…æ–¹æ¡ˆ

### åˆ†é…åŸåˆ™

1. **å·¥ä½œé‡å¹³è¡¡**: ä¸¤ä¸ªå¼€å‘è€…å·¥ä½œé‡å°½é‡æ¥è¿‘
2. **ä¾èµ–å…³ç³»**: è€ƒè™‘æ¨¡å—ä¹‹é—´çš„ä¾èµ–ï¼Œé¿å…é˜»å¡
3. **ç‹¬ç«‹æ€§**: å°½é‡åˆ†é…ç‹¬ç«‹æ¨¡å—ï¼Œå‡å°‘å†²çª
4. **æŠ€èƒ½åŒ¹é…**: è€ƒè™‘å¼€å‘è€…çš„æŠ€èƒ½åå¥½

---

## ğŸ‘¥ ä»»åŠ¡åˆ†é…è¯¦æƒ…

### å¼€å‘è€… Aï¼ˆè´Ÿè´£äººï¼‰ğŸ‘¨â€ğŸ’»

**èŒè´£**:

- æ ¸å¿ƒç³»ç»Ÿé‡æ„
- çŠ¶æ€ç®¡ç†é‡æ„ï¼ˆzustandï¼‰
- åŸºç¡€è®¾æ–½æ­å»º

#### é˜¶æ®µ 1: çŠ¶æ€ç®¡ç†é‡æ„ï¼ˆä¼˜å…ˆçº§ï¼šæœ€é«˜ï¼‰

**ä»»åŠ¡ 1.1: å¼•å…¥ zustand å¹¶åˆ›å»º Store**

- [x] å®‰è£… zustand: `npm install zustand`
- [x] åˆ›å»º `store/gameStore.ts` - æ¸¸æˆçŠ¶æ€ï¼ˆplayer, logs, settingsï¼‰
- [x] åˆ›å»º `store/uiStore.ts` - UI çŠ¶æ€ï¼ˆmodals, loading, cooldownï¼‰
- [x] åˆ›å»º `store/index.ts` - Store ç»Ÿä¸€å¯¼å‡º

**é¢„æœŸæ—¶é—´**: 2-3 å¤©

**ä»»åŠ¡ 1.2: è¿ç§»ç°æœ‰çŠ¶æ€**

- [x] å°† `useGameState` é€»è¾‘è¿ç§»åˆ° `gameStore` âœ… (å·²å®Œæˆï¼šuseGameState.ts å·²æ”¹ä¸ºå…¼å®¹å±‚)
- [x] å°† `useAppState` é€»è¾‘è¿ç§»åˆ° `uiStore` âœ… (å·²å®Œæˆï¼šuseAppState.ts å·²æ”¹ä¸ºå…¼å®¹å±‚)
- [x] æ›´æ–° `App.tsx` ä½¿ç”¨ zustand âœ… (å·²å®Œæˆï¼šApp.tsx å·²ç›´æ¥ä½¿ç”¨ zustand stores)
- [x] è¿ç§» `ModalsContainer` å’Œ `useRebirth` ä» UIContext åˆ°ç›´æ¥ä½¿ç”¨ zustand âœ…
- [x] ç§»é™¤ä¸å†éœ€è¦çš„ `UIProvider` å’Œ `UIContext` âœ…
- [x] ä¼˜åŒ– App.tsx ä¸­çš„é€‰æ‹©å™¨æ€§èƒ½ï¼ˆæŒ‰åŠŸèƒ½æ‹†åˆ†ï¼Œä½¿ç”¨ useShallowï¼‰âœ…
- [x] å‡å°‘ä»£ç é‡å¤ï¼ˆæå– commonHandlersParamsï¼‰âœ…
- [ ] æµ‹è¯•çŠ¶æ€è¿ç§»

**é¢„æœŸæ—¶é—´**: 2-3 å¤©
**å½“å‰çŠ¶æ€**: âœ… è¿ç§»å’Œä¼˜åŒ–å·²å®Œæˆï¼ŒåŒ…æ‹¬ï¼š
- App.tsx å·²å®Œå…¨è¿ç§»åˆ°ç›´æ¥ä½¿ç”¨ zustand stores
- UIContext å·²ç§»é™¤ï¼Œæ‰€æœ‰ç»„ä»¶ç›´æ¥ä½¿ç”¨ zustand
- æ€§èƒ½ä¼˜åŒ–å·²å®Œæˆï¼ˆé€‰æ‹©å™¨æ‹†åˆ†ã€useShallow ä¼˜åŒ–ï¼‰
- ä»£ç é‡å¤å·²å‡å°‘
- å¾…åŠŸèƒ½æµ‹è¯•éªŒè¯

---

#### é˜¶æ®µ 2: æ ¸å¿ƒç³»ç»Ÿé‡æ„ï¼ˆä¼˜å…ˆçº§ï¼šé«˜ï¼‰

**ä»»åŠ¡ 2.1: Adventureï¼ˆå†ç»ƒï¼‰ç³»ç»Ÿ** â­â­â­â­â­

- [ ] é‡æ„ `views/adventure/useAdventureHandlers.ts` ä½¿ç”¨ zustand
- [ ] ä¼˜åŒ– `services/adventureTemplateService.ts`
- [ ] æå– Service å±‚ï¼ˆçº¯å‡½æ•°ï¼‰
- [ ] æµ‹è¯•å†ç»ƒåŠŸèƒ½

**å¤æ‚åº¦**: æœ€é«˜
**é¢„æœŸæ—¶é—´**: 3-4 å¤©
**ä¾èµ–**: æ— ï¼ˆæ ¸å¿ƒæ¨¡å—ï¼Œå…¶ä»–æ¨¡å—ä¾èµ–å®ƒï¼‰

**ä»»åŠ¡ 2.2: Battleï¼ˆæˆ˜æ–—ï¼‰ç³»ç»Ÿ** â­â­â­â­

- [ ] é‡æ„ `views/battle/useBattleHandlers.ts` ä½¿ç”¨ zustand
- [ ] ä¼˜åŒ– `services/battleService.ts`
- [ ] æå– Service å±‚
- [ ] æµ‹è¯•æˆ˜æ–—åŠŸèƒ½

**å¤æ‚åº¦**: é«˜
**é¢„æœŸæ—¶é—´**: 2-3 å¤©
**ä¾èµ–**: adventureï¼ˆå¯å¹¶è¡Œå¼€å‘ï¼‰

**ä»»åŠ¡ 2.3: Realmï¼ˆç§˜å¢ƒï¼‰ç³»ç»Ÿ** â­â­â­â­

- [ ] é‡æ„ `views/realm/useRealmHandlers.ts` ä½¿ç”¨ zustand
- [ ] æå– Service å±‚
- [ ] æµ‹è¯•ç§˜å¢ƒåŠŸèƒ½

**å¤æ‚åº¦**: é«˜
**é¢„æœŸæ—¶é—´**: 2-3 å¤©
**ä¾èµ–**: adventureï¼ˆå¯å¹¶è¡Œå¼€å‘ï¼‰

**ä»»åŠ¡ 2.4: Sectï¼ˆå®—é—¨ï¼‰ç³»ç»Ÿ** â­â­â­â­

- [ ] é‡æ„ `views/sect/useSectHandlers.ts` ä½¿ç”¨ zustand
- [ ] ä¼˜åŒ– `services/randomService.ts`ï¼ˆå®—é—¨ä»»åŠ¡ç”Ÿæˆï¼‰
- [ ] æå– Service å±‚
- [ ] æµ‹è¯•å®—é—¨åŠŸèƒ½

**å¤æ‚åº¦**: é«˜
**é¢„æœŸæ—¶é—´**: 3-4 å¤©
**ä¾èµ–**: adventure, shop

---

#### é˜¶æ®µ 3: åŸºç¡€åŠŸèƒ½ç³»ç»Ÿï¼ˆä¼˜å…ˆçº§ï¼šä¸­ï¼‰

**ä»»åŠ¡ 3.1: Meditationï¼ˆæ‰“åï¼‰ç³»ç»Ÿ** â­â­

- [x] é‡æ„ `views/meditation/useMeditationHandlers.ts` ä½¿ç”¨ zustand âœ… (å·²å®Œæˆï¼šå·²è¿ç§»åˆ°ç›´æ¥ä½¿ç”¨ zustand store)
- [ ] æå– Service å±‚
- [ ] æµ‹è¯•æ‰“ååŠŸèƒ½

**é¢„æœŸæ—¶é—´**: 1-2 å¤©
**å½“å‰çŠ¶æ€**: âœ… zustand è¿ç§»å·²å®Œæˆï¼ŒuseMeditationHandlers ç°åœ¨ç›´æ¥ä» store è·å–çŠ¶æ€

**ä»»åŠ¡ 3.2: Breakthroughï¼ˆçªç ´ï¼‰ç³»ç»Ÿ** â­â­â­

- [ ] é‡æ„ `views/breakthrough/useBreakthroughHandlers.ts` ä½¿ç”¨ zustand
- [ ] æå– Service å±‚
- [ ] æµ‹è¯•çªç ´åŠŸèƒ½

**é¢„æœŸæ—¶é—´**: 2-3 å¤©
**ä¾èµ–**: cultivation

**ä»»åŠ¡ 3.3: Cultivationï¼ˆåŠŸæ³•ï¼‰ç³»ç»Ÿ** â­â­

- [x] é‡æ„ `views/cultivation/useCultivationHandlers.ts` ä½¿ç”¨ zustand âœ… (å·²å®Œæˆï¼šå·²è¿ç§»åˆ°ç›´æ¥ä½¿ç”¨ zustand store)
- [ ] æå– Service å±‚
- [ ] æµ‹è¯•åŠŸæ³•åŠŸèƒ½

**é¢„æœŸæ—¶é—´**: 1-2 å¤©
**å½“å‰çŠ¶æ€**: âœ… zustand è¿ç§»å·²å®Œæˆ

**ä»»åŠ¡ 3.4: Characterï¼ˆè§’è‰²ï¼‰ç³»ç»Ÿ** â­â­

- [x] é‡æ„ `views/character/useCharacterHandlers.ts` ä½¿ç”¨ zustand âœ… (å·²å®Œæˆï¼šå·²è¿ç§»åˆ°ç›´æ¥ä½¿ç”¨ zustand store)
- [ ] æå– Service å±‚
- [ ] æµ‹è¯•è§’è‰²åŠŸèƒ½

**é¢„æœŸæ—¶é—´**: 1-2 å¤©
**å½“å‰çŠ¶æ€**: âœ… zustand è¿ç§»å·²å®Œæˆ

---

#### é˜¶æ®µ 4: App.tsx æ‹†åˆ†å’Œä¼˜åŒ–

**ä»»åŠ¡ 4.1: æ‹†åˆ† App.tsx**

- [ ] åˆ›å»º `components/GameContainer.tsx`
- [ ] åˆ›å»º `hooks/useGameLogic.ts`ï¼ˆèšåˆæ‰€æœ‰ handlersï¼‰
- [ ] ç®€åŒ– App.tsx åˆ° 200-300 è¡Œ
- [ ] æµ‹è¯•åŠŸèƒ½å®Œæ•´æ€§

**é¢„æœŸæ—¶é—´**: 2-3 å¤©

**ä»»åŠ¡ 4.2: æ€§èƒ½å’Œå®‰å…¨ä¼˜åŒ–**

- [ ] ä¿®å¤æ‰€æœ‰ useEffect ä¾èµ–é—®é¢˜
- [ ] ç»Ÿä¸€å®šæ—¶å™¨ç®¡ç†
- [ ] é˜²æ­¢æ— é™å¾ªç¯
- [ ] æ·»åŠ  React.memo ä¼˜åŒ–

**é¢„æœŸæ—¶é—´**: 2-3 å¤©

---

### å¼€å‘è€… Bï¼ˆåä½œè€…ï¼‰ğŸ‘¨â€ğŸ’»

**èŒè´£**:

- ç‰©å“å’Œè£…å¤‡ç³»ç»Ÿ
- å•†åº—å’Œäº¤æ˜“ç³»ç»Ÿ
- è¾…åŠ©ç³»ç»Ÿï¼ˆå® ç‰©ã€æŠ½å¥–ã€æˆå°±ç­‰ï¼‰

#### é˜¶æ®µ 1: ç‰©å“å’Œè£…å¤‡ç³»ç»Ÿï¼ˆä¼˜å…ˆçº§ï¼šé«˜ï¼‰

**ä»»åŠ¡ 1.1: Itemsï¼ˆç‰©å“ï¼‰ç³»ç»Ÿ** â­â­

- [ ] åˆ›å»º `services/itemService.ts`ï¼ˆçº¯å‡½æ•°ï¼‰
- [ ] é‡æ„ `views/items/useItemHandlers.ts` ä½¿ç”¨ zustand
- [ ] æå–ä¸šåŠ¡é€»è¾‘åˆ° Service å±‚
- [ ] ç¼–å†™å•å…ƒæµ‹è¯•
- [ ] æµ‹è¯•ç‰©å“åŠŸèƒ½

**é¢„æœŸæ—¶é—´**: 2-3 å¤©
**ä¾èµ–**: æ— ï¼ˆåŸºç¡€æ¨¡å—ï¼Œå…¶ä»–æ¨¡å—ä¾èµ–å®ƒï¼‰

**ä»»åŠ¡ 1.2: Equipmentï¼ˆè£…å¤‡ï¼‰ç³»ç»Ÿ** â­â­

- [ ] åˆ›å»º `services/equipmentService.ts`ï¼ˆçº¯å‡½æ•°ï¼‰
- [ ] é‡æ„ `views/equipment/useEquipmentHandlers.ts` ä½¿ç”¨ zustand
- [ ] æå–ä¸šåŠ¡é€»è¾‘åˆ° Service å±‚
- [ ] ç¼–å†™å•å…ƒæµ‹è¯•
- [ ] æµ‹è¯•è£…å¤‡åŠŸèƒ½

**é¢„æœŸæ—¶é—´**: 2-3 å¤©
**ä¾èµ–**: items

**ä»»åŠ¡ 1.3: ä¼˜åŒ– Item Utils**

- [ ] ä¼˜åŒ– `utils/itemUtils.ts`
- [ ] ä¼˜åŒ– `utils/equipmentUtils.ts`
- [ ] ä¼˜åŒ– `utils/inventoryUtils.ts`
- [ ] ä»£ç å®¡æŸ¥

**é¢„æœŸæ—¶é—´**: 1-2 å¤©

---

#### é˜¶æ®µ 2: äº¤æ˜“å’Œå•†åº—ç³»ç»Ÿï¼ˆä¼˜å…ˆçº§ï¼šé«˜ï¼‰

**ä»»åŠ¡ 2.1: Shopï¼ˆå•†åº—ï¼‰ç³»ç»Ÿ** â­â­

- [x] é‡æ„ `views/shop/useShopHandlers.ts` ä½¿ç”¨ zustand âœ… (å·²å®Œæˆï¼šå·²è¿ç§»åˆ°ç›´æ¥ä½¿ç”¨ zustand store)
- [ ] æå– Service å±‚
- [ ] æµ‹è¯•å•†åº—åŠŸèƒ½

**é¢„æœŸæ—¶é—´**: 1-2 å¤©
**å½“å‰çŠ¶æ€**: âœ… zustand è¿ç§»å·²å®Œæˆ

---

- [ ] ä¼˜åŒ– `services/shopService.ts`
- [ ] é‡æ„ `views/shop/useShopHandlers.ts` ä½¿ç”¨ zustand
- [ ] æå–ä¸šåŠ¡é€»è¾‘åˆ° Service å±‚
- [ ] ç¼–å†™å•å…ƒæµ‹è¯•
- [ ] æµ‹è¯•å•†åº—åŠŸèƒ½

**é¢„æœŸæ—¶é—´**: 2-3 å¤©
**ä¾èµ–**: items

**ä»»åŠ¡ 2.2: Alchemyï¼ˆç‚¼ä¸¹ï¼‰ç³»ç»Ÿ** â­â­â­

- [ ] åˆ›å»º `services/alchemyService.ts`ï¼ˆçº¯å‡½æ•°ï¼‰
- [x] é‡æ„ `views/alchemy/useAlchemyHandlers.ts` ä½¿ç”¨ zustand âœ… (å·²å®Œæˆï¼šå·²è¿ç§»åˆ°ç›´æ¥ä½¿ç”¨ zustand store)
- [ ] æå–ä¸šåŠ¡é€»è¾‘åˆ° Service å±‚
- [ ] ç¼–å†™å•å…ƒæµ‹è¯•
- [ ] æµ‹è¯•ç‚¼ä¸¹åŠŸèƒ½

**é¢„æœŸæ—¶é—´**: 2-3 å¤©
**ä¾èµ–**: items

---

#### é˜¶æ®µ 3: è¾…åŠ©ç³»ç»Ÿï¼ˆä¼˜å…ˆçº§ï¼šä¸­ï¼‰

**ä»»åŠ¡ 3.1: Petï¼ˆçµå® ï¼‰ç³»ç»Ÿ** â­â­â­

- [ ] åˆ›å»º `services/petService.ts`ï¼ˆçº¯å‡½æ•°ï¼‰
- [x] é‡æ„ `views/pet/usePetHandlers.ts` ä½¿ç”¨ zustand âœ… (å·²å®Œæˆï¼šå·²è¿ç§»åˆ°ç›´æ¥ä½¿ç”¨ zustand store)
- [ ] æå–ä¸šåŠ¡é€»è¾‘åˆ° Service å±‚
- [ ] ç¼–å†™å•å…ƒæµ‹è¯•
- [ ] æµ‹è¯•çµå® åŠŸèƒ½

**é¢„æœŸæ—¶é—´**: 3-4 å¤©
**ä¾èµ–**: items
**å½“å‰çŠ¶æ€**: âœ… zustand è¿ç§»å·²å®Œæˆ

**ä»»åŠ¡ 3.2: Lotteryï¼ˆæŠ½å¥–ï¼‰ç³»ç»Ÿ** â­â­

- [ ] åˆ›å»º `services/lotteryService.ts`ï¼ˆçº¯å‡½æ•°ï¼‰
- [x] é‡æ„ `views/lottery/useLotteryHandlers.ts` ä½¿ç”¨ zustand âœ… (å·²å®Œæˆï¼šå·²è¿ç§»åˆ°ç›´æ¥ä½¿ç”¨ zustand store)
- [ ] æå–ä¸šåŠ¡é€»è¾‘åˆ° Service å±‚
- [ ] ç¼–å†™å•å…ƒæµ‹è¯•
- [ ] æµ‹è¯•æŠ½å¥–åŠŸèƒ½

**é¢„æœŸæ—¶é—´**: 1-2 å¤©
**å½“å‰çŠ¶æ€**: âœ… zustand è¿ç§»å·²å®Œæˆ

**ä»»åŠ¡ 3.3: Achievementï¼ˆæˆå°±ï¼‰ç³»ç»Ÿ** â­â­

- [ ] åˆ›å»º `services/achievementService.ts`ï¼ˆçº¯å‡½æ•°ï¼‰
- [ ] é‡æ„ `views/achievement/useAchievementHandlers.ts` ä½¿ç”¨ zustand
- [ ] æå–ä¸šåŠ¡é€»è¾‘åˆ° Service å±‚
- [ ] ç¼–å†™å•å…ƒæµ‹è¯•
- [ ] æµ‹è¯•æˆå°±åŠŸèƒ½

**é¢„æœŸæ—¶é—´**: 2-3 å¤©

**ä»»åŠ¡ 3.4: DailyQuestï¼ˆæ—¥å¸¸ä»»åŠ¡ï¼‰ç³»ç»Ÿ** â­â­â­

- [ ] åˆ›å»º `services/dailyQuestService.ts`ï¼ˆçº¯å‡½æ•°ï¼‰
- [ ] é‡æ„ `views/dailyQuest/useDailyQuestHandlers.ts` ä½¿ç”¨ zustand
- [ ] æå–ä¸šåŠ¡é€»è¾‘åˆ° Service å±‚
- [ ] ç¼–å†™å•å…ƒæµ‹è¯•
- [ ] æµ‹è¯•æ—¥å¸¸ä»»åŠ¡åŠŸèƒ½

**é¢„æœŸæ—¶é—´**: 2-3 å¤©
**ä¾èµ–**: æ‰€æœ‰æ¨¡å—ï¼ˆéœ€è¦åœ¨æœ€åå®Œæˆï¼‰

**ä»»åŠ¡ 3.5: Grottoï¼ˆæ´åºœï¼‰ç³»ç»Ÿ** â­â­â­

- [ ] åˆ›å»º `services/grottoService.ts`ï¼ˆçº¯å‡½æ•°ï¼‰
- [ ] é‡æ„ `views/grotto/useGrottoHandlers.ts` ä½¿ç”¨ zustand
- [ ] æå–ä¸šåŠ¡é€»è¾‘åˆ° Service å±‚
- [ ] ç¼–å†™å•å…ƒæµ‹è¯•
- [ ] æµ‹è¯•æ´åºœåŠŸèƒ½

**é¢„æœŸæ—¶é—´**: 2-3 å¤©
**ä¾èµ–**: items

**ä»»åŠ¡ 3.6: Settingsï¼ˆè®¾ç½®ï¼‰ç³»ç»Ÿ** â­

- [ ] é‡æ„ `views/settings/useSettingsHandlers.ts` ä½¿ç”¨ zustand
- [ ] æå– Service å±‚
- [ ] æµ‹è¯•è®¾ç½®åŠŸèƒ½

**é¢„æœŸæ—¶é—´**: 1 å¤©

---

#### é˜¶æ®µ 4: Hooks é‡æ„å’Œä¼˜åŒ–

**ä»»åŠ¡ 4.1: é‡æ„æ¸¸æˆç›¸å…³ Hooks**

- [ ] é‡æ„ `hooks/useGameEffects.ts` ä½¿ç”¨ zustand
- [ ] é‡æ„ `hooks/useAutoFeatures.ts` ä½¿ç”¨ zustand
- [ ] é‡æ„ `hooks/usePassiveRegeneration.ts` ä½¿ç”¨ zustand
- [ ] é‡æ„ `hooks/useAutoGrottoHarvest.ts` ä½¿ç”¨ zustand
- [ ] é‡æ„ `hooks/useLevelUp.ts` ä½¿ç”¨ zustand
- [ ] é‡æ„ `hooks/useRebirth.ts` ä½¿ç”¨ zustand

**é¢„æœŸæ—¶é—´**: 3-4 å¤©

**ä»»åŠ¡ 4.2: ä¼˜åŒ–æˆ˜æ–—ç›¸å…³ Hooks**

- [ ] é‡æ„ `hooks/useBattleResultHandler.ts` ä½¿ç”¨ zustand
- [ ] é‡æ„ `hooks/useDeathDetection.ts` ä½¿ç”¨ zustand
- [ ] æµ‹è¯•æˆ˜æ–—æµç¨‹

**é¢„æœŸæ—¶é—´**: 2 å¤©

---

#### é˜¶æ®µ 5: ç»„ä»¶ä¼˜åŒ–

**ä»»åŠ¡ 5.1: ä¼˜åŒ– Modal ç»„ä»¶**

- [ ] ä¼˜åŒ–æ‰€æœ‰ Modal ç»„ä»¶ä½¿ç”¨ zustand
- [ ] æ·»åŠ  React.memo ä¼˜åŒ–
- [ ] ç»Ÿä¸€ Modal ç»„ä»¶ç»“æ„
- [ ] æµ‹è¯•æ‰€æœ‰å¼¹çª—åŠŸèƒ½

**é¢„æœŸæ—¶é—´**: 3-4 å¤©

**ä»»åŠ¡ 5.2: ä¼˜åŒ– Panel ç»„ä»¶**

- [ ] ä¼˜åŒ– StatsPanel ä½¿ç”¨ zustand
- [ ] ä¼˜åŒ– LogPanel ä½¿ç”¨ zustand
- [ ] ä¼˜åŒ– EquipmentPanel ä½¿ç”¨ zustand
- [ ] æ·»åŠ  React.memo ä¼˜åŒ–

**é¢„æœŸæ—¶é—´**: 2 å¤©

---

## ğŸ“… æ—¶é—´çº¿è§„åˆ’

### ç¬¬ 1 å‘¨ï¼ˆåŸºç¡€æ­å»ºï¼‰

**å¼€å‘è€… A**:

- çŠ¶æ€ç®¡ç†é‡æ„ï¼ˆzustand å¼•å…¥å’Œè¿ç§»ï¼‰
- å¼€å§‹ Adventure ç³»ç»Ÿé‡æ„

**å¼€å‘è€… B**:

- Items ç³»ç»Ÿé‡æ„
- Equipment ç³»ç»Ÿé‡æ„

---

### ç¬¬ 2 å‘¨ï¼ˆæ ¸å¿ƒç³»ç»Ÿï¼‰

**å¼€å‘è€… A**:

- å®Œæˆ Adventure ç³»ç»Ÿ
- Battle ç³»ç»Ÿé‡æ„
- Realm ç³»ç»Ÿé‡æ„

**å¼€å‘è€… B**:

- Shop ç³»ç»Ÿé‡æ„
- Alchemy ç³»ç»Ÿé‡æ„
- å¼€å§‹ Pet ç³»ç»Ÿ

---

### ç¬¬ 3 å‘¨ï¼ˆåŠŸèƒ½å®Œå–„ï¼‰

**å¼€å‘è€… A**:

- Sect ç³»ç»Ÿé‡æ„
- Meditation, Breakthrough, Cultivation, Character ç³»ç»Ÿ
- å¼€å§‹ App.tsx æ‹†åˆ†

**å¼€å‘è€… B**:

- å®Œæˆ Pet ç³»ç»Ÿ
- Lottery, Achievement ç³»ç»Ÿ
- Grotto ç³»ç»Ÿ
- Settings ç³»ç»Ÿ

---

### ç¬¬ 4 å‘¨ï¼ˆä¼˜åŒ–å’Œæ”¶å°¾ï¼‰

**å¼€å‘è€… A**:

- å®Œæˆ App.tsx æ‹†åˆ†
- æ€§èƒ½å’Œå®‰å…¨ä¼˜åŒ–
- Code Review

**å¼€å‘è€… B**:

- Hooks é‡æ„
- ç»„ä»¶ä¼˜åŒ–
- DailyQuest ç³»ç»Ÿï¼ˆæœ€åå®Œæˆï¼Œä¾èµ–æ‰€æœ‰æ¨¡å—ï¼‰

---

### ç¬¬ 5 å‘¨ï¼ˆæµ‹è¯•å’Œæ–‡æ¡£ï¼‰

**ä¸¤äººåä½œ**:

- å®Œæ•´åŠŸèƒ½æµ‹è¯•
- æ€§èƒ½æµ‹è¯•
- ä¿®å¤ Bug
- æ›´æ–°æ–‡æ¡£
- æœ€ç»ˆ Code Review

---

## ğŸ“Š å·¥ä½œé‡ç»Ÿè®¡

### å¼€å‘è€… A

| é˜¶æ®µ         | ä»»åŠ¡æ•° | é¢„ä¼°æ—¶é—´     | ç´¯è®¡æ—¶é—´     |
| ------------ | ------ | ------------ | ------------ |
| çŠ¶æ€ç®¡ç†é‡æ„ | 2      | 4-6 å¤©       | 4-6 å¤©       |
| æ ¸å¿ƒç³»ç»Ÿé‡æ„ | 4      | 10-14 å¤©     | 14-20 å¤©     |
| åŸºç¡€åŠŸèƒ½ç³»ç»Ÿ | 4      | 5-9 å¤©       | 19-29 å¤©     |
| App.tsx æ‹†åˆ† | 2      | 4-6 å¤©       | 23-35 å¤©     |
| **æ€»è®¡**     | **12** | **23-35 å¤©** | **23-35 å¤©** |

### å¼€å‘è€… B

| é˜¶æ®µ           | ä»»åŠ¡æ•° | é¢„ä¼°æ—¶é—´     | ç´¯è®¡æ—¶é—´     |
| -------------- | ------ | ------------ | ------------ |
| ç‰©å“å’Œè£…å¤‡ç³»ç»Ÿ | 3      | 5-8 å¤©       | 5-8 å¤©       |
| äº¤æ˜“å’Œå•†åº—ç³»ç»Ÿ | 2      | 4-6 å¤©       | 9-14 å¤©      |
| è¾…åŠ©ç³»ç»Ÿ       | 6      | 12-18 å¤©     | 21-32 å¤©     |
| Hooks é‡æ„     | 2      | 5-6 å¤©       | 26-38 å¤©     |
| ç»„ä»¶ä¼˜åŒ–       | 2      | 5-6 å¤©       | 31-44 å¤©     |
| **æ€»è®¡**       | **15** | **31-44 å¤©** | **31-44 å¤©** |

**æ³¨æ„**: å¼€å‘è€… B çš„ä»»åŠ¡æ•°é‡è¾ƒå¤šï¼Œä½†å¤§éƒ¨åˆ†å¤æ‚åº¦è¾ƒä½ã€‚å¦‚æœæ—¶é—´ç´§å¼ ï¼Œå¯ä»¥ï¼š

1. å°†éƒ¨åˆ†ç»„ä»¶ä¼˜åŒ–ä»»åŠ¡å»¶å
2. å¼€å‘è€… A ååŠ©å®Œæˆéƒ¨åˆ†è¾…åŠ©ç³»ç»Ÿ

---

## ğŸ”„ æ¨¡å—ä¾èµ–å…³ç³»å›¾

```
zustand Storeï¼ˆA è´Ÿè´£ï¼‰
  â”‚
  â”œâ”€ Adventureï¼ˆAï¼‰â­â­â­â­â­ æ ¸å¿ƒæ¨¡å—
  â”‚   â”œâ”€ Battleï¼ˆAï¼‰â­â­â­â­
  â”‚   â”œâ”€ Realmï¼ˆAï¼‰â­â­â­â­
  â”‚   â””â”€ Sectï¼ˆAï¼‰â­â­â­â­
  â”‚
  â”œâ”€ Itemsï¼ˆBï¼‰â­â­ åŸºç¡€æ¨¡å—
  â”‚   â”œâ”€ Equipmentï¼ˆBï¼‰â­â­
  â”‚   â”œâ”€ Shopï¼ˆBï¼‰â­â­
  â”‚   â”œâ”€ Alchemyï¼ˆBï¼‰â­â­â­
  â”‚   â”œâ”€ Petï¼ˆBï¼‰â­â­â­
  â”‚   â””â”€ Grottoï¼ˆBï¼‰â­â­â­
  â”‚
  â”œâ”€ Cultivationï¼ˆAï¼‰â­â­
  â”‚   â””â”€ Breakthroughï¼ˆAï¼‰â­â­â­
  â”‚
  â”œâ”€ Meditationï¼ˆAï¼‰â­â­
  â”œâ”€ Characterï¼ˆAï¼‰â­â­
  â”œâ”€ Lotteryï¼ˆBï¼‰â­â­
  â”œâ”€ Achievementï¼ˆBï¼‰â­â­
  â”œâ”€ Settingsï¼ˆBï¼‰â­
  â”‚
  â””â”€ DailyQuestï¼ˆBï¼‰â­â­â­ ä¾èµ–æ‰€æœ‰æ¨¡å—ï¼ˆæœ€åå®Œæˆï¼‰
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### åä½œå»ºè®®

1. **æ¯æ—¥åŒæ­¥**: å»ºè®®æ¯å¤©åŒæ­¥è¿›åº¦ï¼Œè®¨è®ºé‡åˆ°çš„é—®é¢˜
2. **ä»£ç å®¡æŸ¥**: æ¯ä¸ªé˜¶æ®µå®Œæˆåè¿›è¡Œ Code Review
3. **åˆ†æ”¯ç®¡ç†**:
   - ä¸»åˆ†æ”¯: `main`
   - å¼€å‘åˆ†æ”¯: `develop`
   - åŠŸèƒ½åˆ†æ”¯: `feature/zustand-store`, `feature/adventure-refactor` ç­‰
4. **å†²çªå¤„ç†**: å¦‚æœé‡åˆ°å†²çªï¼Œä¼˜å…ˆæ²Ÿé€šè§£å†³

### ä¾èµ–å…³ç³»å¤„ç†

1. **zustand Store**: å¿…é¡»æœ€å…ˆå®Œæˆï¼ˆA è´Ÿè´£ï¼‰
2. **Adventure**: æ ¸å¿ƒæ¨¡å—ï¼Œå…¶ä»–æ¨¡å—ä¾èµ–å®ƒï¼Œä¼˜å…ˆå®Œæˆï¼ˆA è´Ÿè´£ï¼‰
3. **Items**: åŸºç¡€æ¨¡å—ï¼Œå¤šä¸ªæ¨¡å—ä¾èµ–å®ƒï¼Œä¼˜å…ˆå®Œæˆï¼ˆB è´Ÿè´£ï¼‰
4. **DailyQuest**: ä¾èµ–æ‰€æœ‰æ¨¡å—ï¼Œæœ€åå®Œæˆï¼ˆB è´Ÿè´£ï¼‰

### æµ‹è¯•ç­–ç•¥

1. **å•å…ƒæµ‹è¯•**: Service å±‚å‡½æ•°å¿…é¡»ç¼–å†™å•å…ƒæµ‹è¯•
2. **é›†æˆæµ‹è¯•**: æ¯ä¸ªæ¨¡å—é‡æ„åéƒ½è¦è¿›è¡Œå®Œæ•´çš„åŠŸèƒ½æµ‹è¯•
3. **å›å½’æµ‹è¯•**: ç¡®ä¿é‡æ„ååŠŸèƒ½ä¸ä¸¢å¤±

---

## ğŸ“ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. âœ… **ç¡®è®¤åˆ†å·¥**: ä¸¤äººç¡®è®¤ä»»åŠ¡åˆ†é…
2. âœ… **åˆ›å»ºåˆ†æ”¯**: åˆ›å»ºå¼€å‘åˆ†æ”¯å’ŒåŠŸèƒ½åˆ†æ”¯
3. âœ… **å®‰è£…ä¾èµ–**: å®‰è£… zustand
4. âœ… **çŠ¶æ€ç®¡ç†é‡æ„**: zustand Store å·²åˆ›å»ºï¼Œå…¼å®¹å±‚å·²å®Œæˆ
5. ğŸš€ **ä¸‹ä¸€æ­¥**: è¿ç§» App.tsx ç›´æ¥ä½¿ç”¨ zustandï¼Œç„¶åå¼€å§‹æ¨¡å—è¿ç§»

---

## ğŸ“Š å½“å‰å®é™…è¿›åº¦ï¼ˆ2024å¹´æ›´æ–°ï¼‰

### âœ… å·²å®Œæˆï¼ˆçº¦ 20%ï¼‰

**é˜¶æ®µ 1.1: çŠ¶æ€ç®¡ç†åŸºç¡€è®¾æ–½** âœ… 100%
- âœ… zustand å·²å®‰è£…å¹¶é›†æˆ
- âœ… `store/gameStore.ts` å®Œæ•´å®ç°ï¼ˆ327è¡Œï¼‰
- âœ… `store/uiStore.ts` å®Œæ•´å®ç°ï¼ˆ410è¡Œï¼‰
- âœ… `store/index.ts` ç»Ÿä¸€å¯¼å‡º

**é˜¶æ®µ 1.2: å…¼å®¹å±‚è¿ç§»** âœ… 100%
- âœ… `hooks/useGameState.ts` - å·²æ”¹ä¸ºå…¼å®¹å±‚ï¼Œä» zustand gameStore è¯»å–
- âœ… `hooks/useAppState.ts` - å·²æ”¹ä¸ºå…¼å®¹å±‚ï¼Œä» zustand uiStore è¯»å–

### âš ï¸ è¿›è¡Œä¸­ï¼ˆçº¦ 5%ï¼‰

**é˜¶æ®µ 1.2: ç›´æ¥ä½¿ç”¨ zustand** âœ… å·²å®Œæˆ
- âœ… `App.tsx` - å·²å®Œå…¨è¿ç§»åˆ°ç›´æ¥ä½¿ç”¨ zustand storesï¼ˆ`useGameStore`, `useUIStore`ï¼‰
- âœ… `ModalsContainer` - å·²è¿ç§»åˆ°ç›´æ¥ä½¿ç”¨ zustand
- âœ… `useRebirth` - å·²è¿ç§»åˆ°ç›´æ¥ä½¿ç”¨ zustand
- âœ… `UIProvider` å’Œ `UIContext` - å·²ç§»é™¤
- âœ… æ€§èƒ½ä¼˜åŒ–å·²å®Œæˆï¼ˆé€‰æ‹©å™¨æ‹†åˆ†ã€useShallow ä¼˜åŒ–ï¼‰
- âš ï¸ æ‰€æœ‰ views æ¨¡å— - ä»é€šè¿‡ props æ¥æ”¶ `player/setPlayer`ï¼Œæœªä½¿ç”¨ zustand

### âŒ æœªå¼€å§‹ï¼ˆçº¦ 80%ï¼‰

**é˜¶æ®µ 2-4: æ‰€æœ‰æ¨¡å—é‡æ„å’Œä¼˜åŒ–**
- âŒ æ‰€æœ‰æ ¸å¿ƒç³»ç»Ÿã€åŸºç¡€åŠŸèƒ½ç³»ç»Ÿå‡æœªè¿ç§»
- âŒ App.tsx æ‹†åˆ†å’Œä¼˜åŒ–æœªå¼€å§‹

### ğŸ” å…³é”®å‘ç°

1. **æ¶æ„å‡†å¤‡å°±ç»ª**: zustand Store å®ç°å®Œæ•´ï¼Œå¯ä½œä¸ºçŠ¶æ€ç®¡ç†ä¸­å¿ƒ
2. **å…¼å®¹å±‚è®¾è®¡è‰¯å¥½**: å…è®¸æ¸è¿›å¼è¿ç§»ï¼Œä¸å½±å“ç°æœ‰åŠŸèƒ½
3. **è¿ç§»å°šæœªå¼€å§‹**: å®é™…æ¨¡å—è¿ç§»å·¥ä½œå¾…æ‰§è¡Œ

### ğŸ’¡ å»ºè®®ä¼˜å…ˆçº§

**é«˜ä¼˜å…ˆçº§**:
1. âœ… è¿ç§» `App.tsx` ç›´æ¥ä½¿ç”¨ zustandï¼ˆå·²å®Œæˆï¼‰
2. è¿ç§»åŸºç¡€æ¨¡å—ï¼ˆItemsã€Equipmentï¼‰ä½œä¸ºç¤ºä¾‹
3. åŠŸèƒ½æµ‹è¯•éªŒè¯è¿ç§»åçš„çŠ¶æ€ç®¡ç†

**ä¸­ä¼˜å…ˆçº§**:
3. æŒ‰ä¾èµ–å…³ç³»é€æ­¥è¿ç§» views æ¨¡å—
4. å®Œæˆæ‰€æœ‰æ¨¡å—è¿ç§»åç§»é™¤å…¼å®¹å±‚

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.1
**åˆ›å»ºæ—¶é—´**: 2024å¹´
**æœ€åæ›´æ–°**: 2024å¹´ï¼ˆè¿›åº¦æ›´æ–°ï¼‰
